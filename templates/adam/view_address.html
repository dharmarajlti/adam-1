{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}


    <div class="container">
        <header class="blog-header py-3">
            <div class="row flex-nowrap justify-content-between align-items-center">
                <div class="col-4 pt-1">

                </div>
                <div class="col-4 text-center">
                    <a class="blog-header-logo text-dark text-decoration-none" href="#"> ADAMS </a>
                </div>
                <div class="col-4 d-flex justify-content-end align-items-center">

                </div>
            </div>
        </header>


    </div>

    <main class="container">
        <div class="row">
            <div class="col-md-12">
                <article class="blog-post">

                    <div class="table-responsive">
                    <table class="table table-bordered table-hover" id="viewAddress">
                        <thead>
                            <tr>
                                <th scope="col"> Panel No </th>
                                <th scope="col"> Player No  </th>
                                <th scope="col"> Market  </th>
                                <th scope="col">Co ordinates</th>
                                <th scope="col"> Description  </th>
                                <th scope="col"> City  </th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for add in address_data %}
                            <tr>
                                <td>
                                    <address class="mb-0">
                                        {{add.panel_no}}
                                    </address>
                                </td>
                                <td>
                                    <address class="mb-0">
                                        {{add.player_no}}
                                    </address>
                                </td>
                                <td>
                                    <address class="mb-0">
                                        {{add.market_name}}
                                    </address>
                                </td>
                                <td>
                                    <a href="#" class="map-btn button" data-latLng="{{add.longitude}},{{add.latitude}}">
                                        {{add.longitude}},{{add.latitude}}
                                    </a>
                                </td>
                                <td>
                                    <address class="mb-0">
                                        {{add.description}}
                                    </address>
                                </td>
                                <td>
                                    <address class="mb-0">
                                        {{add.city}}
                                    </address>
                                </td>

                            </tr>
                        {% endfor %}

                        </tbody>

                    </table>
                    </div>
                </article>

            </div>



            <div class="col-md-12">
                <div class="pt-3">
                    <div id="map" class="map mb-3" style='height: 500px;'></div>
                </div>
            </div>
        </div>
        </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>

        $(document).on("click", ".button", function (e) {
            e.preventDefault();
            var latLng = $(this).attr("data-latLng");
            let newLat = latLng.split(',');
            let long = parseFloat(newLat[0]);
            let lat = parseFloat(newLat[1]);
            // initialize(latLng);
            // let locationValuesa = long + ',' + lat;

            mapboxgl.accessToken = 'pk.eyJ1IjoicHJhdmVlbmxrdW1hciIsImEiOiJjbDBncnp6MGcwMHBkM29vMjE2YjB5ZXJ2In0.luURpRwktZMoOvxihp_J_A';
            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v11', // style URL
                center: [long, lat], // starting position [lng, lat]
                // center: latLng,
                zoom: 14 // starting zoom
            });

            // Create a default Marker and add it to the map.
            const marker1 = new mapboxgl.Marker()
                .setLngLat([long, lat])
                .addTo(map);



        }); 
    </script>
<script src="{% static "calc/js/main.js" %}"></script>
{% endblock %}